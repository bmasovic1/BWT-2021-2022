const {createClient} = require('soap')
const wsdl = 'http://www.holidaywebservice.com/HolidayService_v2/HolidayService2.asmx?wsdl'

createClient(wsdl, (err, client) => {
  if (err) {
    console.error(err)
    process.exit(1)
  } else {
    client.on('request', (xml) => console.log(xml))
    client.on('response', (xml) => console.log(xml))
    /* client
      .GetHolidayDate({
        countryCode: 'Canada',
        holidayCode: 'NEW-YEARS-DAY-ACTUAL',
        year: '2017'
      }, (err, res) => {
        if (err) {
          console.error(err)
          process.exit(1)
        } else {
          console.log(res)
          process.exit(0)
        }
      }) */
    client
      .GetHolidaysForDateRange({
        countryCode: 'Canada',
        startDate: new Date('2016-01-01').toISOString(),
        endDate: new Date('2016-12-31').toISOString()
      }, (err, res) => {
        if (err) {
          console.error(err)
          process.exit(1)
        } else {
          console.log(res)
          process.exit(0)
        }
      })
  }
})
